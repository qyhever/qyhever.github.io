<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="vue,">





  <link rel="alternate" href="/atom.xml" title="正在缓冲99%" type="application/atom+xml">






<meta name="description" content="图片上传无论什么项目，大概都少不了图片上传。作为常见的需求，很多地方会使用到，应该单独封装一个上传组件，方便复用。 这里使用 vue + element-ui-upload + 七牛云完成上传 前端调用七牛 API现在主流的七牛云上传方式大概为授权式上传，大概为如下过程：  请求后端接口获取上传凭证 token（后端通过accessKey，secretKey，bucket 生成 token） 请求">
<meta name="keywords" content="vue">
<meta property="og:type" content="article">
<meta property="og:title" content="element-ui上传图片到七牛云">
<meta property="og:url" content="http://qyhever.top/2018/05/28/element-ui上传图片到七牛云-md/index.html">
<meta property="og:site_name" content="正在缓冲99%">
<meta property="og:description" content="图片上传无论什么项目，大概都少不了图片上传。作为常见的需求，很多地方会使用到，应该单独封装一个上传组件，方便复用。 这里使用 vue + element-ui-upload + 七牛云完成上传 前端调用七牛 API现在主流的七牛云上传方式大概为授权式上传，大概为如下过程：  请求后端接口获取上传凭证 token（后端通过accessKey，secretKey，bucket 生成 token） 请求">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-10-27T15:52:15.651Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="element-ui上传图片到七牛云">
<meta name="twitter:description" content="图片上传无论什么项目，大概都少不了图片上传。作为常见的需求，很多地方会使用到，应该单独封装一个上传组件，方便复用。 这里使用 vue + element-ui-upload + 七牛云完成上传 前端调用七牛 API现在主流的七牛云上传方式大概为授权式上传，大概为如下过程：  请求后端接口获取上传凭证 token（后端通过accessKey，secretKey，bucket 生成 token） 请求">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://qyhever.top/2018/05/28/element-ui上传图片到七牛云-md/">





  <title>element-ui上传图片到七牛云 | 正在缓冲99%</title>
  









  <!-- 
  <script type="text/javascript"
  color="0,0,255" opacity='0.7' zIndex="-2" count="99" src="https://cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
   -->
  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":true,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <!-- <div class="headband"></div> -->
    <!-- <a href="https://github.com/qyhever"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a> -->
    <a href="https://github.com/qyhever" class="github-corner" aria-label="View source on Github"><svg width="92" height="92" viewbox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a>
    <style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">正在缓冲99%</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Qin Yonghao's Personal Website</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

<div class="player">
	<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="280" height="86" src="//music.163.com/outchain/player?type=2&id=4874896&auto=1&height=66"></iframe>
</div>
<!-- //music.163.com/outchain/player?type=2&id=1304257&auto=0&height=66 -->
 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://qyhever.top/2018/05/28/element-ui上传图片到七牛云-md/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="getElementById">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/me.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="正在缓冲99%">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">element-ui上传图片到七牛云</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-28T11:35:25+08:00">
                2018-05-28
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue/" itemprop="url" rel="index">
                    <span itemprop="name">vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,622 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  12 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="图片上传"><a href="#图片上传" class="headerlink" title="图片上传"></a>图片上传</h3><p>无论什么项目，大概都少不了图片上传。作为常见的需求，很多地方会使用到，应该单独封装一个上传组件，方便复用。</p>
<p>这里使用 vue + element-ui-upload + 七牛云完成上传</p>
<h3 id="前端调用七牛-API"><a href="#前端调用七牛-API" class="headerlink" title="前端调用七牛 API"></a>前端调用七牛 API</h3><p>现在主流的七牛云上传方式大概为授权式上传，大概为如下过程：</p>
<ul>
<li>请求后端接口获取上传凭证 token（后端通过accessKey，secretKey，bucket 生成 token）</li>
<li>请求七牛云的接口地址完成上传</li>
<li>七牛云服务器返回图片地址（返回 hash，key，需要自己拼接下）</li>
</ul>
<p>如果说后端很好，在服务器端直接调用七牛上传接口，那么前端只需要传一个文件给后端，前端方面会简单许多。</p>
<p>不过我是没有遇到的，而且前端调用上传接口，可控性会更强些</p>
<p>关于七牛云的上传地址：</p>
<ul>
<li><a href="https://up-z2.qiniu.com" target="_blank" rel="noopener">https://up-z2.qiniu.com</a></li>
<li><a href="https://up-z2.qiniup.com" target="_blank" rel="noopener">https://up-z2.qiniup.com</a></li>
<li><a href="https://upload-z2.qiniu.com" target="_blank" rel="noopener">https://upload-z2.qiniu.com</a></li>
<li><a href="https://upload-z2.qiniup.com" target="_blank" rel="noopener">https://upload-z2.qiniup.com</a></li>
</ul>
<p>经过测试，上面四个接口都是可用的（https 或者 http），我这里的空间是华南区域，不同区域会有所不同，<a href="https://developer.qiniu.com/kodo/manual/1671/region-endpoint" target="_blank" rel="noopener">可以参考</a></p>
<p>七牛 API，有 3 个参数，token、file、key（可选），其中 key 是文件名，不传会自动生成</p>
<p>首先分析下需求，完成的 upload 组件，要和表单结合起来，意味着要实现双向绑定，调用这个组件的时候，只需要绑定 value（图片url） 属性，组件内部上传完成后通过 $emit(‘input’, url) 改变 value，这样就很方便了</p>
<p>下面介绍下 el-upload 组件：</p>
<ol>
<li>action  属性是上传的接口地址，直接用上面的七牛云的上传地址</li>
<li>name 字段是文件流的参数字段名，默认值为 file，七牛云上传的文件流参数字段就是 file，所以这里可以忽略</li>
<li>data 属性是需要传递的参数，七牛云的上传地址所需参数包括 file（插件会自动传递）、key、token，key 可以不传（七牛自动生成），我们只需要获取 token，在调用七牛之前将 token 塞到 data 中就可以了</li>
<li>before-upload 属性是上传文件之前的钩子，这里调用后端接口获取到上传需要的 token，塞到 data 中，然后别忘了 resolve，因为获取 token 是异步过程，所以在钩子里面返回 Promise，请求成功后 resolve 进行上传（如果有校验文件大小、文件类型的需求也可以在钩子中完成，提前返回 false 就可以了）</li>
</ol>
<p>下面是代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-upload</span><br><span class="line">    v-loading=&quot;loading&quot;</span><br><span class="line">    class=&quot;uploader&quot;</span><br><span class="line">    :class=&quot;&#123;&apos;hover-mask&apos;: value&#125;&quot;</span><br><span class="line">    action=&quot;https://up-z2.qiniup.com&quot;</span><br><span class="line">    :show-file-list=&quot;false&quot;</span><br><span class="line">    :data=&quot;param&quot;</span><br><span class="line">    accept=&quot;image/*&quot;</span><br><span class="line">    :on-success=&quot;handleSuccess&quot;</span><br><span class="line">    :before-upload=&quot;handlebeforeUpload&quot;&gt;</span><br><span class="line">      &lt;img v-if=&quot;value&quot; :src=&quot;value&quot; class=&quot;avatar&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-plus uploader-icon&quot;&gt;&lt;/i&gt;</span><br><span class="line">  &lt;/el-upload&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import axios from &apos;axios&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    value: String,</span><br><span class="line">    required: true</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      loading: &apos;&apos;,</span><br><span class="line">      param: &#123;</span><br><span class="line">        token: &apos;&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleSuccess(res, file) &#123;</span><br><span class="line">      this.loading = false</span><br><span class="line">      // 如果不传 key 参数，就使用七牛自动生成的 hash 值，如果传递了 key 参数，那么就用返回的 key 值</span><br><span class="line">      const &#123; hash &#125; = res</span><br><span class="line">      // 拼接得到图片 url</span><br><span class="line">      const imageUrl = &apos;your domain prefix&apos; + hash</span><br><span class="line">      // 触发事件 input，父组件会修改绑定的 value 值</span><br><span class="line">      this.$emit(&apos;input&apos;, imageUrl)</span><br><span class="line">    &#125;,</span><br><span class="line">    handlebeforeUpload(file) &#123;</span><br><span class="line">      // 这里做可以做文件校验操作</span><br><span class="line">      const isImg = /^image\/\w+$/i.test(file.type)</span><br><span class="line">      if (!isImg) &#123;</span><br><span class="line">        this.$message.error(&apos;只能上传 JPG、PNG、GIF 格式!&apos;)</span><br><span class="line">        return false</span><br><span class="line">      &#125;</span><br><span class="line">      return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">        this.loading = true</span><br><span class="line">        // 获取token</span><br><span class="line">        const tokenUrl = &apos;http://xxx/upload&apos;</span><br><span class="line">        axios.get(tokenUrl).then(res =&gt; &#123;</span><br><span class="line">          const &#123; token &#125; = res.data.data</span><br><span class="line">          this.param.token = token</span><br><span class="line">          resolve(true)</span><br><span class="line">        &#125;).catch(err =&gt; &#123;</span><br><span class="line">          this.loading = false</span><br><span class="line">          reject(err)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">  .uploader &#123;</span><br><span class="line">    width: 130px;</span><br><span class="line">    height: 130px;</span><br><span class="line">    border: 1px dashed #d9d9d9;</span><br><span class="line">    border-radius: 6px;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    &amp;:hover &#123;</span><br><span class="line">      border-color: #409EFF;</span><br><span class="line">    &#125;</span><br><span class="line">    /deep/ .el-upload &#123;</span><br><span class="line">      position: relative;</span><br><span class="line">      width: 100%;</span><br><span class="line">      height: 100%;</span><br><span class="line">      overflow: hidden;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  .uploader-icon &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">    line-height: 128px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    font-size: 28px;</span><br><span class="line">    color: #8c939d;</span><br><span class="line">  &#125;</span><br><span class="line">  .avatar + .uploader-icon &#123;</span><br><span class="line">    opacity: 0;</span><br><span class="line">  &#125;</span><br><span class="line">  .avatar &#123;</span><br><span class="line">    width: 128px;</span><br><span class="line">    height: 128px;</span><br><span class="line">    display: block;</span><br><span class="line">    border-radius: 6px;</span><br><span class="line">  &#125;</span><br><span class="line">  .hover-mask:hover .uploader-icon &#123;</span><br><span class="line">    opacity: 1;</span><br><span class="line">    background-color: rgba(0, 0, 0, .2);</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>如何使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-form ref=&quot;form&quot; :model=&quot;form&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;头像&quot; prop=&quot;avatar&quot;&gt;</span><br><span class="line">      &lt;upload v-model=&quot;form.avatar&quot;&gt;&lt;/upload&gt;</span><br><span class="line">  	&lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;姓名&quot; prop=&quot;userName&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.userName&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">  	&lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">	&lt;el-button type=&quot;primary&quot; @click=&quot;onSubmit&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Upload from &apos;@/components/Upload&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123; Upload &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      form: &#123;</span><br><span class="line">        avatar: &apos;&apos;,</span><br><span class="line">        userName: &apos;&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onSubmit() &#123;</span><br><span class="line">      this.$refs.form.validata(valid =&gt; &#123;</span><br><span class="line">        if (valid) &#123;</span><br><span class="line">          // 将 this.form 传给后端</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>实现双向绑定后，收集数据会非常方便，调用后端接口直接传递绑定的值就 ok 了</p>
<h3 id="前端直接调用后端上传接口"><a href="#前端直接调用后端上传接口" class="headerlink" title="前端直接调用后端上传接口"></a>前端直接调用后端上传接口</h3><p>如果后端很好（铁哥们），前端只需要传递 file 对象，那就更简单了，在上传前置钩子中就不用获取 token，这部分工作都由后端去处理，我们只需要调用上传接口就可以</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-upload</span><br><span class="line">    v-loading=&quot;loading&quot;</span><br><span class="line">    class=&quot;uploader&quot;</span><br><span class="line">    :class=&quot;&#123;&apos;hover-mask&apos;: value&#125;&quot;</span><br><span class="line">    action=&quot;your upload api&quot;</span><br><span class="line">    :show-file-list=&quot;false&quot;</span><br><span class="line">    :on-success=&quot;handleSuccess&quot;</span><br><span class="line">    :before-upload=&quot;handlebeforeUpload&quot;&gt;</span><br><span class="line">      &lt;img v-if=&quot;value&quot; :src=&quot;value&quot; class=&quot;avatar&quot;&gt;</span><br><span class="line">    	&lt;i class=&quot;el-icon-plus uploader-icon&quot;&gt;&lt;/i&gt;</span><br><span class="line">  &lt;/el-upload&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import axios from &apos;axios&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    value: String,</span><br><span class="line">    required: true</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      loading: &apos;&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleSuccess(res, file) &#123;</span><br><span class="line">      this.loading = false</span><br><span class="line">      const &#123; hash &#125; = res</span><br><span class="line">      const imageUrl = &apos;your domain prefix&apos; + hash</span><br><span class="line">      this.$emit(&apos;input&apos;, imageUrl)</span><br><span class="line">    &#125;,</span><br><span class="line">    handlebeforeUpload(file) &#123;</span><br><span class="line">      // 不需要操作可以直接 返回 true</span><br><span class="line">      return true</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>其实，我们在组件上使用<code>v-model</code>的时候，实际上是下面这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;custom-upload</span><br><span class="line">  :value=&quot;form.avatar&quot;</span><br><span class="line">  @input=&quot;form.avatar = $event&quot;</span><br><span class="line">&gt;&lt;/custom-upload&gt;</span><br></pre></td></tr></table></figure>
<p>为了让它正常工作，<code>custom-upload</code>组件内必须：</p>
<ul>
<li>将其 <code>value</code> 特性绑定到一个名叫 <code>value</code> 的 prop 上（这里就是图片地址）</li>
<li>需要修<code>value</code>时，将新的值通过自定义的 <code>input</code> 事件抛出（这里就是上传成功后的<code>$emit(&#39;input&#39;, 图片地址)</code>）</li>
</ul>
<p>所以 <code>v-model</code>是一个语法糖，一种简写形式。如果想要双向绑定，又想自定义，那么可以使用上面的方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;custom-upload</span><br><span class="line">  :url=&quot;form.avatar&quot;</span><br><span class="line">  @update:url=&quot;form.avatar = $event&quot;</span><br><span class="line">&gt;&lt;/custom-upload&gt;</span><br></pre></td></tr></table></figure>
<p>那么在子组件内部就接受<code>url</code>属性，作为图片地址就可以了，在更新<code>url</code>时，也要与绑定的事件名一致<code>$emit(&#39;update:url&#39;, 图片地址)</code>，事件名使用<code>update:propName</code>是<code>vue</code>推荐的风格，目的是提醒开发者这是一个双向绑定的属性。</p>
<p>当然，为了方便起见，<code>vue</code>为这种模式提供一个缩写，即 <code>.sync</code> 修饰符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;custom-upload :url.sync=&quot;form.avatar&quot;&gt;&lt;/custom-upload&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>带有 <code>.sync</code> 修饰符的值不能为表达式（例如<code>:url.sync=&quot;domain + form.avatar&quot;</code>是无效的）</p>
</blockquote>
<h3 id="多图上传"><a href="#多图上传" class="headerlink" title="多图上传"></a>多图上传</h3><p>有时候类似上传资料、凭证这类的需求要求上传多张图片，我们可以再封装一个多图上传的组件</p>
<p>对于 el-upload，多张图片上传注意如下几点：</p>
<ol>
<li>props 的 value 不再是<code>string</code>，应该是一个数组，数组成员为图片地址<code>[&#39;url1&#39;, &#39;url2&#39;]</code></li>
<li>file-list属性为上传的文件列表，我们不能直接把 value 赋值给它，file-list应该是一个数组，例如<code>[{name: &#39;foo.jpg&#39;, url: &#39;xxx&#39;}, {name: &#39;bar.jpg&#39;, url: &#39;xxx&#39;}]</code>。这与我们传进来的数据不一样，需要处理一下 value（当然我们使用组件时可以直接传递需要的这种格式，就不用处理了）</li>
<li>show-file-list 设置为 true，当然可以不传，它默认为 true</li>
<li>list-type 可以设置为 <code>&#39;picture-card&#39;</code>，图片将以卡片形式显示</li>
<li>on-remove 属性为文件列表移除文件时的钩子，这里需要触发事件，更新 value</li>
<li>on-preview 属性为点击文件列表中已上传的文件时的钩子，可以做图片预览</li>
<li>limit 属性可以指定最大允许上传个数，配合 on-exceed 属性（文件超出个数限制时的钩子）使用，当上传超过指定值后，在这个钩子里面做些提示</li>
</ol>
<p>下面是代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;el-upload</span><br><span class="line">      :action=&quot;QINIU_UPLOAD_URL&quot;</span><br><span class="line">      :data=&quot;param&quot;</span><br><span class="line">      :file-list=&quot;fileList&quot;</span><br><span class="line">      list-type=&quot;picture-card&quot;</span><br><span class="line">      :limit=&quot;limit&quot;</span><br><span class="line">      :on-exceed=&quot;handleUploadExceed&quot;</span><br><span class="line">      :on-preview=&quot;handlePictureCardPreview&quot;</span><br><span class="line">      :on-remove=&quot;handleRemove&quot;</span><br><span class="line">      :before-upload=&quot;handlebeforeUpload&quot;</span><br><span class="line">      :on-success=&quot;handleSuccess&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;el-icon-plus&quot;&gt;&lt;/i&gt;</span><br><span class="line">    &lt;/el-upload&gt;</span><br><span class="line">    &lt;el-dialog :visible.sync=&quot;dialogVisible&quot;&gt;</span><br><span class="line">      &lt;img width=&quot;100%&quot; :src=&quot;dialogImageUrl&quot; alt=&quot;&quot;&gt;</span><br><span class="line">    &lt;/el-dialog&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import axios from &apos;axios&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    value: &#123;</span><br><span class="line">      type: Array,</span><br><span class="line">      default: () =&gt; []</span><br><span class="line">    &#125;,</span><br><span class="line">    limit: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: 4</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      dialogImageUrl: &apos;&apos;, // 当前预览图片地址</span><br><span class="line">      dialogVisible: false, // 预览弹框 visible</span><br><span class="line">      param: &#123;</span><br><span class="line">        token: &apos;&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  computed: &#123;</span><br><span class="line">    // [&apos;xxx&apos;, &apos;xxx&apos;] 转换为 [&#123;url: &apos;xxx&apos;&#125;, &#123;url: &apos;xxx&apos;&#125;]</span><br><span class="line">    fileList() &#123;</span><br><span class="line">      return this.value.map(url =&gt; (&#123; url &#125;))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleUploadExceed() &#123;</span><br><span class="line">      this.$message.error(`最多上传$&#123;this.limit&#125;张图片`)</span><br><span class="line">    &#125;,</span><br><span class="line">    handleRemove(file, fileList) &#123;</span><br><span class="line">      // fileList 为删除后的文件列表</span><br><span class="line">      const value = fileList.map(v =&gt; v.url)</span><br><span class="line">      this.$emit(&apos;input&apos;, value)</span><br><span class="line">    &#125;,</span><br><span class="line">    handlePictureCardPreview(file) &#123;</span><br><span class="line">      this.dialogImageUrl = file.url</span><br><span class="line">      this.dialogVisible = true</span><br><span class="line">    &#125;,</span><br><span class="line">    handlebeforeUpload(file) &#123;</span><br><span class="line">      return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">        axios.get(&apos;/upload/qiniuToken&apos;).then(res =&gt; &#123;</span><br><span class="line">          const &#123; token &#125; = res.data</span><br><span class="line">          this.param.token = token</span><br><span class="line">          resolve(true)</span><br><span class="line">        &#125;).catch(err =&gt; &#123;</span><br><span class="line">          reject(err)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    handleSuccess(res, file) &#123;</span><br><span class="line">      const &#123; hash &#125; = res</span><br><span class="line">      const imageUrl = this.QINIU_PREFIX + hash</span><br><span class="line">      // 这里如果 this.value.push(imageUrl) 这么写，vue会报出警告，大概意思是value作为props不应该在子组件中被修改</span><br><span class="line">      // 应该根据 value 得到新的值，而不能修改它，this.value.concat(imageUrl)也是可以的，concat方法返回新的数组</span><br><span class="line">      this.$emit(&apos;input&apos;, [...this.value, imageUrl])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>如何使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;el-form ref=&quot;form&quot; :model=&quot;form&quot;&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;还款金额&quot; prop=&quot;amount&quot;&gt;</span><br><span class="line">      &lt;el-input v-model=&quot;form.amount&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=&quot;凭证&quot; prop=&quot;voucherUrlList&quot;&gt;</span><br><span class="line">      &lt;multi-upload v-model=&quot;form.voucherUrlList&quot;&gt;&lt;/multi-upload&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line">  &lt;el-button type=&quot;primary&quot; @click=&quot;onSubmit&quot;&gt;确 定&lt;/el-button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import MultiUpload from &apos;@/components/MultiUpload&apos;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123; MultiUpload &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      form: &#123;</span><br><span class="line">        amount: &apos;&apos;,</span><br><span class="line">        voucherUrlList: []</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onSubmit() &#123;</span><br><span class="line">      this.$refs.form.validata(valid =&gt; &#123;</span><br><span class="line">        if (valid) &#123;</span><br><span class="line">          // 将 this.form 传给后端</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>把上传组件封装成双向绑定的形式后，我们使用会更方便，也方便复用。</p>

      
    </div>
    
    
    

    

    

    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:17px;">------------- 本文结束<i class="fa fa-paw"></i>感谢您的阅读 -------------</div>
    
</div>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/vue/" rel="tag">
              <i class="fa fa-tag"></i>
              vue
            </a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/05/10/你真的会用JSON-stringify吗/" rel="next" title="你真的会用JSON.stringify吗">
                <i class="fa fa-chevron-left"></i> 你真的会用JSON.stringify吗
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/06/21/新兴API-requestAnimationFrame/" rel="prev" title="新兴API - requestAnimationFrame">
                新兴API - requestAnimationFrame <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/me.png" alt="getElementById">
            
              <p class="site-author-name" itemprop="name">getElementById</p>
              <p class="site-description motion-element" itemprop="description">Standing on shoulders of giants.</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com" target="_blank" title="GitHub">
                      GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im" target="_blank" title="掘金">
                      掘金</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://segmentfault.com" target="_blank" title="SegmentFault">
                      SegmentFault</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://cnodejs.org" target="_blank" title="cnode">
                      cnode</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                推荐阅读
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://github.com/lifesinger/blog/issues?q=label:blog" title="玉伯" target="_blank">玉伯</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.ruanyifeng.com" title="阮一峰" target="_blank">阮一峰</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.zhangxinxu.com" title="张鑫旭" target="_blank">张鑫旭</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://i5ting.com" title="i5ting" target="_blank">i5ting</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.alloyteam.com/nav/" title="web前端导航" target="_blank">web前端导航</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://taobaofed.org" title="Taobao FED" target="_blank">Taobao FED</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#图片上传"><span class="nav-number">1.</span> <span class="nav-text">图片上传</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前端调用七牛-API"><span class="nav-number">2.</span> <span class="nav-text">前端调用七牛 API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前端直接调用后端上传接口"><span class="nav-number">3.</span> <span class="nav-text">前端直接调用后端上传接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多图上传"><span class="nav-number">4.</span> <span class="nav-text">多图上传</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">getElementById</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <!--
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">46.0k</span>-->
  <div class="theme-info">
    <div class="powered-by"></div>
    <span class="post-count">博客全站共 46.0k 字</span>
  </div>
  
</div>


  <!-- <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div> -->




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/global.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

  <script src="https://cdn.bootcss.com/clipboard.js/2.0.1/clipboard.min.js"></script>
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
  
   <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas> 
   <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
   <script type="text/javascript" src="/js/src/fireworks.js"></script>
  
</body>
</html>
